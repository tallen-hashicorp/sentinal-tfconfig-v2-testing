import "tfplan/v2" as tfplan

# Ensure all S3 buckets are private
all_buckets_private = rule {
  all tf.default.resources.aws_s3_bucket as _, bucket {
    bucket.config.acl is "private" or
    not "acl" in bucket.config
  }
}

main = rule {
  all_buckets_private
}